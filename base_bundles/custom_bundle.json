{
  "id": "custom_bundle",
  "name": "Custom modular bundle",
  "comment": "Custom modular bundle",
  "version": "1_0",
  "mappings": [
    {
      "id": "default_mapping",
      "image": {
        "type": "tag",
        "value": "*"
      },
      "name": "default",
      "policy_ids": [
        "default_policy"
      ],
      "registry": "*",
      "repository": "*",
      "whitelist_ids": [
        "default_whitelist"
      ]
    },
    {
      "id": "nginx_mapping",
      "image": {
        "type": "tag",
        "value": "*"
      },
      "name": "nginx mapping",
      "policy_id": "default_policy",
      "registry": "*",
      "repository": "nginx",
      "whitelist_ids": [
        "default_whitelist",
        "nginx_whitelist"
      ]
    }
  ],
  "policies": [
    {
      "comment": "System default policy",
      "id": "default_policy",
      "name": "DefaultPolicy",
      "rules": [
        {
          "action": "STOP",
          "gate": "dockerfile",
          "id": "ce7b8000-829b-4c27-8122-69cd59018400",
          "params": [
            {
              "name": "ports",
              "value": "22"
            },
            {
              "name": "type",
              "value": "blacklist"
            }
          ],
          "trigger": "exposed_ports"
        },
        {
          "action": "WARN",
          "gate": "dockerfile",
          "id": "312d9e41-1c05-4e2f-ad89-b7d34b0855bb",
          "params": [
            {
              "name": "instruction",
              "value": "HEALTHCHECK"
            },
            {
              "name": "check",
              "value": "not_exists"
            }
          ],
          "trigger": "instruction"
        },
        {
          "action": "WARN",
          "gate": "vulnerabilities",
          "id": "6b5c14e7-a6f7-48cc-99d2-959273a2c6fa",
          "params": [
            {
              "name": "max_days_since_sync",
              "value": "2"
            }
          ],
          "trigger": "stale_feed_data"
        },
        {
          "action": "WARN",
          "gate": "vulnerabilities",
          "id": "3e79ea94-18c4-4d26-9e29-3b9172a62c2e",
          "params": [],
          "trigger": "vulnerability_data_unavailable"
        },
        {
          "action": "WARN",
          "gate": "vulnerabilities",
          "id": "6063fdde-b1c5-46af-973a-915739451ac4",
          "params": [
            {
              "name": "package_type",
              "value": "all"
            },
            {
              "name": "severity_comparison",
              "value": "="
            },
            {
              "name": "severity",
              "value": "medium"
            }
          ],
          "trigger": "package"
        },
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "b30e8abc-444f-45b1-8a37-55be1b8c8bb5",
          "params": [
            {
              "name": "package_type",
              "value": "all"
            },
            {
              "name": "severity_comparison",
              "value": ">"
            },
            {
              "name": "severity",
              "value": "medium"
            }
          ],
          "trigger": "package"
        }
      ],
      "version": "1_0"
    }
  ],
  "whitelists": [
    {
      "comment": "Default global whitelist",
      "id": "default_whitelist",
      "items": [],
      "name": "Global Whitelist",
      "version": "1_0"
    },
    {
      "comment": "curl is safe for nginx",
      "id": "nginx_whitelist",
      "items": [
        {
          "comment": "whitelist curl package for nginx",
          "gate": "vulnerabilities",
          "id": "nginx_allow_curl",
          "trigger_id": "*+curl"
        }
      ],
      "name": "nginx whitelist",
      "version": "1_0"
    }
  ],
  "whitelisted_images": [],
  "blacklisted_images": []
}
