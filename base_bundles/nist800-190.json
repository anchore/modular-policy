{
  "blacklisted_images": [],
  "description": "Anchore NIST 800-190 bundle to meet specific image countermeasures discussed in Section 4.1 of NIST 800-190",
  "id": "nist800-190",
  "last_updated": 1603729498,
  "mappings": [
    {
      "id": "nist800-190",
      "image": {
        "type": "tag",
        "value": "*"
      },
      "name": "nist800-190",
      "policy_ids": [
        "5f29d776-ab9f-4170-8ec1-77d569ef3e44",
        "7d0ab291-f072-4d60-ad60-780d9a830f40",
        "b9c86951-7e4c-466e-ba9a-a375104fd646",
        "ba722cf8-b746-4795-a779-ab3b09f93fab",
        "c95f4301-3ec4-4473-8e96-12d0a06b8ee7"
      ],
      "registry": "*",
      "repository": "*",
      "whitelist_ids": [
        "40acc08f-685d-4185-8a56-19995892ccfa"
      ]
    }
  ],
  "name": "nist800-190",
  "policies": [
    {
      "comment": "",
      "id": "64a6f72d-3b39-476e-8e5d-5df992773171",
      "name": "Authorized User",
      "rules": [],
      "version": "1_0"
    },
    {
      "comment": "NIST 800-190 Section 4.1.2 Image Configuration Checks",
      "id": "406e846a-d2fc-4ec0-ac16-d160ce1c3436",
      "name": "File Integrity Checks",
      "rules": [
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "files",
          "id": "ed39cf94-a95b-456b-a58b-46bf30df97b2",
          "params": [
            {
              "name": "regex",
              "value": ".*\\.pem"
            }
          ],
          "trigger": "name_match"
        },
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "passwd_file",
          "id": "5c952129-3b69-4e7b-8e7e-d669c863a1c7",
          "params": [
            {
              "name": "shells",
              "value": "/bin/bash/bin/zsh"
            }
          ],
          "trigger": "blacklist_shells"
        },
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "passwd_file",
          "id": "f5cad6cf-3dc0-4a82-8c2d-8d61d3578ff2",
          "params": [
            {
              "name": "group_ids",
              "value": "999"
            }
          ],
          "trigger": "blacklist_groupids"
        },
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "files",
          "id": "050caad9-f7bf-4ab2-9921-04bf9a798692",
          "params": [
            {
              "name": "regex_name",
              "value": "*password*"
            }
          ],
          "trigger": "content_regex_match"
        },
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "files",
          "id": "1ff8a627-a812-4322-add8-8c2250adf7af",
          "params": [
            {
              "name": "filename",
              "value": "/etc/passwd"
            },
            {
              "name": "mode",
              "value": "00644"
            },
            {
              "name": "mode_op",
              "value": "not_equals"
            }
          ],
          "trigger": "attribute_match"
        },
        {
          "action": "STOP",
          "comment": "Section 4.1.2 of NIST 800-190",
          "gate": "files",
          "id": "db0c2a33-0b1f-4e68-a2db-664e6a66dd02",
          "params": [],
          "trigger": "suid_or_guid_set"
        }
      ],
      "version": "1_0"
    },
    {
      "comment": "Validating Images come from trusted Registries. NIST 800-190 Section 3.1.5",
      "id": "5f29d776-ab9f-4170-8ec1-77d569ef3e44",
      "name": "Authorized Registry Checks",
      "rules": [
        {
          "action": "GO",
          "gate": "dockerfile",
          "id": "d5759209-2d88-4017-bc8c-d90cc83fd059",
          "params": [
            {
              "name": "instruction",
              "value": "FROM"
            },
            {
              "name": "check",
              "value": "not_like"
            },
            {
              "name": "value",
              "value": "example_registry_1"
            }
          ],
          "trigger": "instruction"
        }
      ],
      "version": "1_0"
    },
    {
      "comment": "Protecting secrets content from unauthorized disclosure and modification",
      "id": "c95f4301-3ec4-4473-8e96-12d0a06b8ee7",
      "name": "(IA-5) Secret Checks",
      "rules": [
        {
          "action": "STOP",
          "comment": "IA-5 and NIST 800-190 3.1.4 Embedded clear text secrets",
          "gate": "secret_scans",
          "id": "35a99ffe-2561-4f41-a979-7ee12d5618a2",
          "params": [],
          "trigger": "content_regex_checks"
        }
      ],
      "version": "1_0"
    },
    {
      "comment": "Threshold that is established to control GO/STOP actions for images violatiing vuln threshold",
      "id": "ba722cf8-b746-4795-a779-ab3b09f93fab",
      "name": "(RA-5) Vulnerability Scans",
      "rules": [
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "2ff360bb-718e-4102-9ccd-4b4072e59cb4",
          "params": [],
          "trigger": "vulnerability_data_unavailable"
        },
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "620464d4-536a-488b-a993-cce3d77807cf",
          "params": [
            {
              "name": "max_days_since_sync",
              "value": "1"
            }
          ],
          "trigger": "stale_feed_data"
        },
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "abb7bfd1-75b3-47e5-8ded-6f92ddf921e2",
          "params": [
            {
              "name": "package_type",
              "value": "all"
            },
            {
              "name": "severity_comparison",
              "value": ">="
            },
            {
              "name": "severity",
              "value": "low"
            }
          ],
          "trigger": "package"
        }
      ],
      "version": "1_0"
    },
    {
      "comment": "Checks to validate malware scanning is completed across all images.",
      "id": "7d0ab291-f072-4d60-ad60-780d9a830f40",
      "name": "(SI-3) Malware Checks",
      "rules": [
        {
          "action": "STOP",
          "comment": "SI-3/NIST 800-190 4.1.3",
          "gate": "malware",
          "id": "31ce5033-3787-456e-93b8-d9a5da3728d4",
          "params": [],
          "trigger": "scans"
        },
        {
          "action": "STOP",
          "comment": "SI-3/NIST 800-190 4.1.3",
          "gate": "malware",
          "id": "a8898e7f-4c04-4d1c-951c-7fcdedd2528a",
          "params": [],
          "trigger": "scan_not_run"
        }
      ],
      "version": "1_0"
    },
    {
      "comment": "",
      "id": "b9c86951-7e4c-466e-ba9a-a375104fd646",
      "name": "NIST800-190",
      "rules": [],
      "version": "1_0"
    }
  ],
  "version": "1_0",
  "whitelisted_images": [],
  "whitelists": [
    {
      "comment": "",
      "id": "40acc08f-685d-4185-8a56-19995892ccfa",
      "items": [],
      "name": "DefaultWhitelist",
      "version": "1_0"
    }
  ]
}