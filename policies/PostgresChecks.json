{
  "comment": "Postgres Checks",
  "id": "PostgresChecks",
  "name": "Postgres Checks",
  "rules": [
    {
      "action": "WARN",
      "comment": "Warn if ports other than 5432 exposed",
      "gate": "dockerfile",
      "id": "84db89bd-384d-4a76-ad46-f139e00fd2d3",
      "params": [
        {
          "name": "ports",
          "value": "5432"
        },
        {
          "name": "type",
          "value": "whitelist"
        }
      ],
      "trigger": "exposed_ports"
    },
    {
      "action": "WARN",
      "comment": "Warn if user other than postgres defined",
      "gate": "dockerfile",
      "id": "cee8542d-0e15-4129-a0eb-743532f08eaf",
      "params": [
        {
          "name": "users",
          "value": "postgres"
        },
        {
          "name": "type",
          "value": "whitelist"
        }
      ],
      "trigger": "effective_user"
    }
  ],
  "version": "1_0"
}
