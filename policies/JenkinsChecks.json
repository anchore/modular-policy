{
  "comment": "Jenkins Checks",
  "id": "JenkinsChecks",
  "name": "Jenkins Checks",
  "rules": [
    {
      "action": "WARN",
      "gate": "files",
      "id": "47a71065-187e-4e3f-988e-c39b01155ef8",
      "params": [
        {
          "name": "filename",
          "value": "/etc/passwd"
        },
        {
          "name": "mode",
          "value": "664"
        },
        {
          "name": "mode_op",
          "value": "equals"
        }
      ],
      "trigger": "attribute_match"
    },
    {
      "action": "WARN",
      "comment": "Warn if user other than jenkins defined",
      "gate": "dockerfile",
      "id": "443f0fa5-256c-42b2-b850-3345b5e0bd27",
      "params": [
        {
          "name": "users",
          "value": "jenkins"
        },
        {
          "name": "type",
          "value": "whitelist"
        }
      ],
      "trigger": "effective_user"
    },
    {
      "action": "WARN",
      "comment": "Check if ports other than 8080 or 50000 exposed",
      "gate": "dockerfile",
      "id": "05974ff6-b665-470e-b5db-3743a57ecf83",
      "params": [
        {
          "name": "ports",
          "value": "8080,50000"
        },
        {
          "name": "type",
          "value": "whitelist"
        }
      ],
      "trigger": "exposed_ports"
    }
  ],
  "version": "1_0"
}
